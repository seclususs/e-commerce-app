{% extends "layouts/admin_layout.html" %}

{% block admintitle %}Kelola Varian - {{ product.name }}{% endblock %}
{% block adminheader %}Kelola Varian untuk: {{ product.name }}{% endblock %}

{% block admincontent %}
<div style="margin-bottom: 2rem;">
    <a href="{{ url_for('admin.admin_products') }}" class="cta-button-secondary">&larr; Kembali ke Daftar Produk</a>
</div>

<div class="admin-card animated-element">
    <h3>Tambah Varian Baru</h3>
    <form method="POST" action="{{ url_for('admin.manage_variants', product_id=product.id) }}" class="form-actions">
        <input type="hidden" name="action" value="add">
        <div class="form-group" style="flex-grow: 1; margin-bottom: 0;">
            <label for="size" class="sr-only">Ukuran</label>
            <input type="text" id="size" name="size" placeholder="Nama Ukuran (cth: XL)" required class="form-control">
        </div>
        <div class="form-group" style="flex-grow: 1; margin-bottom: 0;">
            <label for="stock" class="sr-only">Stok</label>
            <input type="number" id="stock" name="stock" placeholder="Jumlah Stok" required class="form-control">
        </div>
        <button type="submit" class="cta-button">Tambah Varian</button>
    </form>
</div>

<div class="admin-card animated-element" data-animation-delay="200">
    <h3>Daftar Varian Saat Ini</h3>
    <p class="form-hint">Total stok dari semua varian: <strong>{{ product.stock }}</strong>. Ini akan diperbarui secara otomatis.</p>
    <div class="table-wrapper">
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID Varian</th>
                    <th>Ukuran</th>
                    <th>Stok</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody>
                {% for variant in variants %}
                <tr class="admin-card-row">
                    <form method="POST" action="{{ url_for('admin.manage_variants', product_id=product.id) }}">
                        <input type="hidden" name="action" value="update">
                        <input type="hidden" name="variant_id" value="{{ variant.id }}">
                        <td data-label="ID:">{{ variant.id }}</td>
                        <td data-label="Ukuran:">
                            <input type="text" name="size" value="{{ variant.size }}" class="form-control" required>
                        </td>
                        <td data-label="Stok:">
                             <input type="number" name="stock" value="{{ variant.stock }}" class="form-control" required>
                        </td>
                        <td data-label="Aksi:" class="action-buttons">
                            <div class="desktop-actions">
                                <button type="submit" class="cta-button-secondary" style="border-color: var(--color-primary); color: var(--color-primary); white-space: nowrap;">Update</button>
                                <a href="{{ url_for('admin.delete_variant', product_id=product.id, variant_id=variant.id) }}" class="action-link action-link-delete" data-no-transition>Hapus</a>
                            </div>
                             <button class="mobile-details-toggle">Lihat Detail <i class="fas fa-chevron-down"></i></button>
                        </td>
                    </form>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4" style="text-align: center;">Belum ada varian untuk produk ini.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}